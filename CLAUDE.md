# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Overview

This is the documentation site for ZaneOps, built with Astro and Starlight. It's a documentation website that provides guides, tutorials, API reference, and knowledge base for the ZaneOps platform.

## Development Commands

| Command | Description |
|---------|-------------|
| `pnpm dev` | Start development server on port 3000 (configurable via PORT env var) |
| `pnpm build` | Run type checking and build for production |
| `pnpm preview` | Preview production build locally |
| `pnpm start` | Alias for `pnpm dev` |

## Code Quality

- **Formatter**: Biome is configured for code formatting (linter disabled, formatter uses tab indents with 80 char line width, JS uses 2-space indents)
- **Type checking**: TypeScript with strict mode (`astro/tsconfigs/strict`), `astro check` runs before builds
- **Package manager**: Use `pnpm` (v10.14.0+) - enforced via packageManager field

## Architecture

### Framework Stack
- **Astro 5.x**: SSR-enabled site (output mode: "server") with Node adapter in standalone mode
- **Starlight**: Astro integration for documentation sites with custom component overrides
- **React 18**: Used for interactive components (JSX configured for React)
- **Tailwind CSS 4.x**: Styling via Vite plugin with custom theme layers
- **TypeScript**: Strict type safety with TSConfig extending `astro/tsconfigs/strict`

### Directory Structure
```
src/
├── assets/           # Images, fonts, global CSS
├── components/       # Astro and React components
├── content/
│   └── docs/        # MDX documentation files
├── pages/           # API routes and special pages
└── styles/          # Additional stylesheets
```

### Content Management
- Documentation content is in `src/content/docs/` as MDX files
- Starlight automatically generates routes from file structure using `docsLoader()`
- Content collections use Starlight's `docsSchema()` (defined in `src/content.config.ts`)
- Sidebar navigation is manually defined in `astro.config.mjs` with mix of explicit items and autogenerated sections (knowledge-base, changelog, tutorials)

### Key Components
- `LandingPage.astro` & `LandingPageCloud.astro`: Homepage variants with testimonials and features
- `BrowserScreenshot.astro`: Component for displaying browser mockups
- `Head.astro` & `Footer.astro`: Custom Starlight component overrides (configured in `astro.config.mjs`)
- `opengraph.tsx`: React component for OpenGraph image generation using Satori
- `LogSectionHome.astro`: Log display component for homepage

### Special Pages & API Routes
- `/llms.txt` & `/llms-full.txt`: AI-readable site maps (auto-generated from docs collection)
- `/ping`: Health check endpoint (TypeScript API route)
- `/api-reference/openapi`: OpenAPI documentation viewer (Astro page)
- `/api/signup-cloud`: Cloud signup API endpoint (SSR, prerender disabled)
- Dynamic OpenGraph images at `/[...route]/og.png`: Auto-generated for all docs using Satori + Resvg with Geist Mono font

## Environment Configuration

The site supports dynamic domain configuration via environment variables:
- `ZANE_DOMAINS`: Comma-separated list of domains (first is used as primary for `site` config, defaults to "zaneops.dev")
- `ASSETS_SERVER_DOMAIN`: Asset server domain (client-side public env var, defaults to "https://assets.zaneops.dev", must be valid URL)

## Styling System

- Tailwind CSS 4.x is configured via Vite plugin (no separate tailwind.config file)
- Custom theme uses layered CSS architecture: base, starlight, theme, components, utilities
- Theme definitions in `src/assets/global.css` with CSS `@theme` directive
- Color system uses Starlight's CSS custom properties with custom overrides for light/dark modes
- Custom colors: `--color-border`, `--color-bg` with dark mode variants
- Font setup in `src/assets/fonts/font-face.css`

## Content Guidelines

- Documentation uses MDX format for rich content
- Images should be optimized and placed in `src/assets/`
- Use Starlight components where possible for consistency
- Follow existing sidebar structure in `astro.config.mjs`
- Edit links point to GitHub repo: `https://github.com/zane-ops/docs/edit/main/`